@page "/"
@page "/home"

@using Model
@using System.Diagnostics

<RadzenDataGrid Data="@teams" AllowColumnResize="true">
    <Columns>
        <RadzenDataGridColumn Property="@nameof(Team.Name)" Title="Team" />
        <RadzenDataGridColumn>
            <Template Context="data">
                <RadzenButton Icon="delete" Click="@(() => DeleteItem(data))" />
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>

@code {
    private Team? Team { get; set; }
    private List<Team> teams = [];

    private async Task AddTeam()
    {
        Team team = new() { Name = "Test" };
        Repository<Team> repo = new(new());
        await repo.InsertAsync(team);
    }

    private async Task GetTeams() => teams = await TeamRepository.GetAllAsync();

    private async Task DeleteItem(Team item)
    {
        Debug.WriteLine(item.Name);

        try
        {
            await TeamRepository.DeleteAsync(item);
            await GetTeams();
        }
        catch (Exception ex)
        {
            Debug.WriteLine($"Error deleting team: {ex.Message}");
        }
    }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await GetTeams();


    }
}
